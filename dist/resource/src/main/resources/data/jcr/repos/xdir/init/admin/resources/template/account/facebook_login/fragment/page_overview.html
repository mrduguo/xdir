<@page_overview_title/>
<#assign groovy = "org.xdir.platform.core.internal.template.freemarker.GroovyDirective"?new()>
<@groovy>

        /*
        
		authUrl="http://www.facebook.com/login.php?v=1.0&api_key=0788b104869014ef4ae6c35c10c7428c&next="+model.pagePath+"/callback.html"
        model.response.sendRedirect(authUrl);
        return "";
        
        
        */
        
		json=model.app.security.get("facebook").requestLoginUrl(model.request,model.pagePath+"/callback"+model.format);
		model.put("json",json);
        authUrl = json.loginUrl;
        if(authUrl.isNull()){
        	return "Failed to talk to Facebook, please try again later.";
        }else{
	        model.response.sendRedirect(authUrl.toString());
        }
	return ""
</@groovy>
<#if !json.loginUrl.isNull()>
<#stop "redirected to login"/>
</#if>